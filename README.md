# Мини-блог на FastAPI с регистрацией, аутентификацией и авторизацией

Этот проект представляет собой мини-блог, разработанный на основе **FastAPI**, с реализацией системы регистрации, аутентификации и авторизации пользователей. Проект включает модульную архитектуру, гибкое логирование через **loguru**, и взаимодействие с базой данных с использованием **SQLAlchemy**. Для управления миграциями используется **Alembic**.

## Основные возможности

1. **Управление пользователями:**
   - Регистрация и вход пользователей.
   - Безопасное хеширование паролей с использованием **bcrypt**.
   - Авторизация с использованием **JWT** токенов через библиотеку **python-jose**.
   - Защита эндпоинтов с помощью ролей и зависимостей.

2. **Функционал блога:**
   - Добавление записей:
     - Создание нового блога с заголовком, текстом и прикрепленными тегами.
     - Возможность сохранять запись как черновик.
   - Удаление записей:
     - Автор может удалить свои записи.
   - Просмотр записей:
     - Получение списка всех опубликованных блогов.
     - Просмотр конкретной записи.
     - Фильтрация записей по тегам.
   - Дерево тегов:
     - Система тегов реализована через отношение Many-to-Many.
     - Автоматическое создание дерева тегов.

3. **Логирование:**
   - Использование **loguru** для удобного управления логами.

4. **Модульная архитектура:**
   - Проект разделен на модули для упрощения поддержки и масштабирования.

## Технологический стек

- **Веб-фреймворк:** FastAPI
- **ORM:** SQLAlchemy с асинхронной поддержкой через aiosqlite
- **База данных:** SQLite (можно заменить на любую SQL-СУБД)
- **Миграции:** Alembic
- **Аутентификация:** bcrypt для хеширования паролей, python-jose для работы с JWT токенами
- **Фронтенд:** HTML + CSS + JS (с использованием Jinja2)

## Структура проекта

```
├── app/
│   ├── auth/                   # Модуль авторизации и аутентификации
│   ├── api/                    # Модуль API мини-блога
│   ├── pages/                  # Модуль фронтенд части
│   ├── dao/                    # Общие DAO для приложения
│   ├── migration/              # Миграции базы данных
│   ├── static/                 # Статические файлы приложения
│   ├── config.py               # Конфигурация приложения
│   ├── database.py             # Подключение к базе данных
│   ├── exceptions.py           # Исключения для обработки ошибок
│   └── main.py                 # Основной файл для запуска приложения
├── data/                       # Файлы базы данных
├── .env                        # Конфигурация окружения
├── .gitignore                  # Файлы, игнорируемые в Git
├── alembic.ini                 # Конфигурация Alembic
├── README.md                   # Документация проекта
└── requirements.txt            # Зависимости проекта
```

## Зависимости

- **Основные:** `fastapi`, `pydantic`, `uvicorn`
- **Для работы с базой данных:** `SQLAlchemy`, `aiosqlite`, `alembic`
- **Для аутентификации:** `bcrypt`, `passlib[bcrypt]`, `python-jose`
- **Шаблонизатор:** `jinja2`
- **Прочее:** `markdown2`, `loguru`

Установить зависимости можно командой:

```bash
pip install -r requirements.txt
```

## Настройка

1. Склонируйте репозиторий:

   ```bash
   git clone https://github.com/Yakvenalex/FastApiWithAuthSample.git .
   ```

2. Настройте файл `.env`:

   ```env
   SECRET_KEY=supersecretkey
   ALGORITHM=HS256
   ```

3. Создайте и примените миграции базы данных:

   ```bash
   cd app
   alembic init -t async migration
   alembic revision --autogenerate -m "Initial migration"
   alembic upgrade head
   ```

4. Запустите приложение:

   ```bash
   uvicorn app.main:app --reload
   ```

Приложение будет доступно по адресу [http://127.0.0.1:8000](http://127.0.0.1:8000).

## Развитие проекта

Этот шаблон предоставляет прочную основу для разработки масштабируемых веб-приложений с аутентификацией, авторизацией и управлением контентом. Возможности легко расширяются за счет модульной архитектуры.

Возможные направления для развития:
- Подключение более мощной SQL-СУБД (например, PostgreSQL).
- Реализация системы комментариев.
- Добавление ролей пользователей (например, администратор, редактор).
- Расширение интерфейса с использованием современных фронтенд-фреймворков (например, Vue.js или React).

## Ссылки на проект

- **Опубликованный блог:** [FastAPI Blog](https://fastapiblog-yakvenalex.amvera.io/blogs/)  
  Перейдите по ссылке, чтобы ознакомиться с работающей версией блога. Здесь вы можете просматривать записи, фильтровать их по тегам, а также оценить реализацию фронтенд-части.

- **Документация API:** [FastAPI Docs](https://fastapiblog-yakvenalex.amvera.io/docs)  
  Полная документация для всех эндпоинтов API, созданная с использованием встроенной системы OpenAPI от FastAPI. Позволяет тестировать API прямо в браузере и изучать входные/выходные данные.
